<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cross Validation · CausalELM.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://dscolby.github.io/CausalELM.jl/reference/crossval/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="CausalELM.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CausalELM.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">CausalELM</a></li><li><span class="tocitem">User Guide</span><ul><li><a class="tocitem" href="../../guide/its/">Interrupted Time Series Estimation</a></li><li><a class="tocitem" href="../../guide/gcomputation/">G-computation</a></li><li><a class="tocitem" href="../../guide/doublemachinelearning/">Double Machine Learning</a></li><li><a class="tocitem" href="../../guide/metalearners/">Metalearners</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api/">CausalELM</a></li><li><a class="tocitem" href="../activations/">Activation Functions</a></li><li class="is-active"><a class="tocitem" href>Cross Validation</a></li><li><a class="tocitem" href="../estimation/">ATE/ATT/ITE Estimation</a></li><li><a class="tocitem" href="../metalearners/">CATE Estimation</a></li><li><a class="tocitem" href="../inference/">Inference and Summarization</a></li><li><a class="tocitem" href="../validation/">Model Validation</a></li><li><a class="tocitem" href="../metrics/">Validation Metrics</a></li><li><a class="tocitem" href="../base/">Base Models</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Cross Validation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cross Validation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/dscolby/CausalELM.jl/blob/main/docs/src/reference/crossval.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Cross-Valdiation"><a class="docs-heading-anchor" href="#Cross-Valdiation">Cross Valdiation</a><a id="Cross-Valdiation-1"></a><a class="docs-heading-anchor-permalink" href="#Cross-Valdiation" title="Permalink"></a></h1><p>Methods to find the optimal number of neurons via cross validation</p><article class="docstring"><header><a class="docstring-binding" id="CausalELM.CrossValidation" href="#CausalELM.CrossValidation"><code>CausalELM.CrossValidation</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Methods to perform cross validation and find the optimum number of neurons.</p><p>To reduce computation time, the number of neurons is optimized by using cross validation to estimate the validation error on a small subset of the range of possible numbers of  neurons. Then, an Extreme Learning Machine is trained to predict validation loss from  the given cross validation sets. Finally, the number of neurons is selected that has the  smallest predicted loss or the highest classification metric.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dscolby/CausalELM.jl/blob/f85d0e2f5a5293365ce3d12bea741edebb69b3da/src/crossval.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalELM.CrossValidation.recode" href="#CausalELM.CrossValidation.recode"><code>CausalELM.CrossValidation.recode</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">recode(ŷ)</code></pre><p>Round predicted values to their predicted class for classification tasks.</p><p>If the smallest predicted label is 0, all labels are shifted up 1; if the smallest  label is -1, all labels are shifted up 2. Also labels cannot be smaller than -1.</p><p>Examples</p><pre><code class="language-julia-repl hljs">julia&gt; recode([-0.7, 0.2, 1.1])
3-element Vector{Float64}
1
2
3
julia&gt; recode([0.1, 0.2, 0.3])
3-element Vector{Float64}
1
1
1
julia&gt; recode([1.1, 1.51, 1.8])
3-element Vector{Float64}
1
2
2</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dscolby/CausalELM.jl/blob/f85d0e2f5a5293365ce3d12bea741edebb69b3da/src/crossval.jl#L16-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalELM.CrossValidation.generate_folds" href="#CausalELM.CrossValidation.generate_folds"><code>CausalELM.CrossValidation.generate_folds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_folds(X, Y, folds)</code></pre><p>Creates folds for cross validation.</p><p>Examples</p><pre><code class="language-julia-repl hljs">julia&gt; xfolds, y_folds = generate_folds(zeros(20, 2), zeros(20), 5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dscolby/CausalELM.jl/blob/f85d0e2f5a5293365ce3d12bea741edebb69b3da/src/crossval.jl#L54-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalELM.CrossValidation.validate_fold" href="#CausalELM.CrossValidation.validate_fold"><code>CausalELM.CrossValidation.validate_fold</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">validate_fold(xtrain, ytrain, xtest, ytest, nodes, metric; activation, regularized)</code></pre><p>Calculate a validation metric for a single fold in k-fold cross validation.</p><p>Examples</p><pre><code class="language-julia-repl hljs">julia&gt; x = rand(100, 5); y = Float64.(rand(100) .&gt; 0.5)
julia&gt; validate_fold(x, y, 5, accuracy, 3)
0.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dscolby/CausalELM.jl/blob/f85d0e2f5a5293365ce3d12bea741edebb69b3da/src/crossval.jl#L87-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalELM.CrossValidation.cross_validate" href="#CausalELM.CrossValidation.cross_validate"><code>CausalELM.CrossValidation.cross_validate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cross_validate(X, Y, neurons, metric, activation, regularized, folds, temporal)</code></pre><p>Calculate a validation metric for k folds using a single set of hyperparameters.</p><p>Examples</p><pre><code class="language-julia-repl hljs">julia&gt; x = rand(100, 5); y = Float64.(rand(100) .&gt; 0.5)
julia&gt; cross_validate(x, y, 5, accuracy)
0.0257841765251021</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dscolby/CausalELM.jl/blob/f85d0e2f5a5293365ce3d12bea741edebb69b3da/src/crossval.jl#L115-L126">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalELM.CrossValidation.best_size" href="#CausalELM.CrossValidation.best_size"><code>CausalELM.CrossValidation.best_size</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">best_size(X, Y, metric, task, activation, min_neurons, max_neurons, regularized, folds, 
    temporal, iterations, approximator_neurons)</code></pre><p>Compute the best number of neurons for an Extreme Learning Machine.</p><p>The procedure tests networks with numbers of neurons in a sequence whose length is given  by iterations on the interval [min<em>neurons, max</em>neurons]. Then, it uses the networks  sizes and validation errors from the sequence to predict the validation error or metric  for every network size between min<em>neurons and max</em>neurons using the function  approximation ability of an Extreme Learning Machine. Finally, it returns the network  size with the best predicted validation error or metric.</p><p>Examples</p><pre><code class="language-julia-repl hljs">julia&gt; best_size(rand(100, 5), rand(100), mse, &quot;regression&quot;)
11</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dscolby/CausalELM.jl/blob/f85d0e2f5a5293365ce3d12bea741edebb69b3da/src/crossval.jl#L151-L169">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CausalELM.CrossValidation.shuffle_data" href="#CausalELM.CrossValidation.shuffle_data"><code>CausalELM.CrossValidation.shuffle_data</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">shuffle_data(X, Y, T)</code></pre><p>Shuffles covariates, treatment vector, and outcome vector for cross validation.</p><p>Examples</p><pre><code class="language-julia-repl hljs">julia&gt; x, y, t = rand(100, 5), rand(100), [rand()&lt;0.4 for i in 1:100]
julia&gt; shuffle_data(x, y, t)
([0.6124923085225416 0.2713900065807924 … 0.6094796972512194 0.6067966603192685; 
0.7186612932571539 0.8047878363606299 … 0.9787878554455594 0.885819212905816; … ; 
0.773543733306263 0.10880091279797399 … 0.10525512055751185 0.6303472234021711; 
0.10845217539341823 0.9911071602976902 … 0.014754069216096566 0.5256103389041187], 
[0.4302689295553531, 0.2396683446618325, 0.7954433314513768, 0.7191098533903124, 
0.8168563428651753, 0.7064320936729905, 0.048113106979693065, 0.3102938851371281, 
0.6246380539228858, 0.3510284321966193  …  0.5324022501182528, 0.8354720951777901, 
0.7526652774981095, 0.3639742621882005, 0.21030903031988923, 0.6936212944871928, 
0.3910592143534404, 0.15152013651215301, 0.38891692138831735, 0.08827711410802941], 
Float64[0, 0, 1, 1, 0, 1, 0, 0, 1, 0  …  0, 0, 1, 1, 1, 1, 0, 1, 0, 0])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/dscolby/CausalELM.jl/blob/f85d0e2f5a5293365ce3d12bea741edebb69b3da/src/crossval.jl#L194-L214">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../activations/">« Activation Functions</a><a class="docs-footer-nextpage" href="../estimation/">ATE/ATT/ITE Estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 26 November 2023 07:38">Sunday 26 November 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
